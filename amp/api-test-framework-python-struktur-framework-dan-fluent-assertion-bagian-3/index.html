<!doctype html><html amp lang="id-ID"><head><meta charset="utf-8"><title>Struktur Framework dan Fluent Assertion - API Test Framework Python (Bagian 3) - Fachrul Choliluddin</title><meta name="description" content="Hi Kawan ðŸ‘‹, Gimana mudah kan belajar bikin API automation dengan python? tentunya,, di kesempatan ini kita akan belajar lebih lanjut dengan pytest dan menggunakan library tambahan (lagi) agar test kita lebih mudah dibaca dan dipahami dengan bantuan fluent assertion Artikel ini adalah salah satu&hellip;"><link rel="canonical" href="https://fachrul.id/api-test-framework-python-struktur-framework-dan-fluent-assertion-bagian-3/"><meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"><link href="https://fonts.googleapis.com/css?family=Roboto:400,700&display=swap" rel="stylesheet" type="text/css"><script async custom-element="amp-sidebar" src="https://cdn.ampproject.org/v0/amp-sidebar-0.1.js"></script><script async custom-element="amp-social-share" src="https://cdn.ampproject.org/v0/amp-social-share-0.1.js"></script><script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script><script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script><script async custom-element="amp-video" src="https://cdn.ampproject.org/v0/amp-video-0.1.js"></script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://fachrul.id/amp/api-test-framework-python-struktur-framework-dan-fluent-assertion-bagian-3/"},"headline":"Struktur Framework dan Fluent Assertion - API Test Framework Python (Bagian 3)","datePublished":"2021-01-29T16:00","dateModified":"2021-08-08T16:36","image":{"@type":"ImageObject","url":"https://fachrul.id/media/website/fachrulch-icon.png","height":1000,"width":1000},"description":"Hi Kawan ðŸ‘‹, Gimana mudah kan belajar bikin API automation dengan python? tentunya,, di kesempatan ini kita akan belajar lebih lanjut dengan pytest dan menggunakan library tambahan (lagi) agar test kita lebih mudah dibaca dan dipahami dengan bantuan fluent assertion Artikel ini adalah salah satu&hellip;","author":{"@type":"Person","name":"Fachrul Choliluddin","url":"https://fachrul.id/amp/authors/fachrulch/"},"publisher":{"@type":"Organization","name":"Fachrul Choliluddin","logo":{"@type":"ImageObject","url":"https://fachrul.id/media/website/fachrulch-icon.png","height":1000,"width":1000}}}</script><style amp-custom>article,
aside,
footer,
header,
hgroup,
main,
nav,
section {
  display: block; }

*,
*:before,
*:after {
  -webkit-box-sizing: content-box;
  box-sizing: content-box;
  margin: 0;
  padding: 0; }

li {
  list-style: none; }

amp-img {
  max-width: 100%; }

button,
input,
select,
textarea {
  font: inherit; }

html {
  font-size: 1rem; }

body {
  background: #f1f1f1;
  color: #262626;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
  line-height: 1.6; }

a {
  color:  #3A9C7D;
  text-decoration: none;
  -webkit-transition: all 0.12s linear 0s;
  -o-transition: all 0.12s linear 0s;
  transition: all 0.12s linear 0s; }

a:hover {
  color: #262626;
  text-decoration: underline;
  -webkit-text-decoration-skip: ink;
  text-decoration-skip: ink; }

a:active {
  color: #262626; }

a:focus {
  outline: 2px dotted #3A9C7D; }

figure,
blockquote,
p,
ul,
ol,
dl,
table,
hr,
fieldset {
  margin-top: 1.6rem; }

h1,
h2,
h3,
h4,
h5,
h6 {
  color: #262626;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
  font-weight: 500;
  line-height: 1.2;
  margin-top: 2.13333rem; }

h1 {
  font-size: 1.67583rem;
  font-weight: normal; }

h2 {
  font-size: 1.4729rem; }

h3 {
  font-size: 1.29454rem; }

h4 {
  font-size: 1.13778rem; }

h5 {
  font-size: 1rem; }

h6 {
  font-size: 0.87891rem; }

h2 + p,
h3 + p,
h4 + p,
h5 + p,
h6 + p {
  margin-top: 0.8rem; }

b,
strong {
  font-weight: 600; }

blockquote {
  color: #6c7175;
  font-family: "Droid Serif", "Times", "Source Serif Pro", serif;
  font-style: italic;
  padding: 1.33333rem 0.53333rem 1.33333rem 3.2rem;
  position: relative; }
  blockquote:before {
    display: block;
    content: "\201C";
    font-size: 4.41226rem;
    position: absolute;
    left: 0;
    top: -12px;
    color: rgba(108, 113, 117, 0.5); }
  blockquote > :nth-child(1) {
    margin-top: 0; }

ul,
ol {
  margin-left: 2rem; }
  ul > li,
  ol > li {
    list-style: inherit;
    padding: 0 0 0.26667rem 0.26667rem; }

dl dt {
  color: #262626;
  font-weight: 600; }

code,
pre {
  background-color: #f1f1f1;
  font-family: monospace; }

pre {
  margin: 1.6rem 0 0;
  padding: 1.6rem;
  white-space: pre-wrap;
  word-wrap: break-word;
  overflow-x: auto; }
  pre > code {
    color: #262626;
    padding: 0; }

code {
  border-radius: 3px;
  color: #262626;
  padding: 0.26667rem 0.53333rem; }

table {
  border-collapse: collapse;
  border-spacing: 0;
  border: 1px solid #d4d4d4;
  width: 100%;
  overflow-x: auto;
  vertical-align: top;
  text-align: left;
  white-space: nowrap; }
  table th {
    font-weight: 500;
    padding: 0.53333rem 1.06667rem; }
  table tr {
    border-bottom: 1px solid #d4d4d4; }
    table tr:nth-child(2n) {
      background: #f1f1f1; }
  table td {
    padding: 0.53333rem 1.06667rem; }

figcaption {
  clear: both;
  color: rgba(108, 113, 117, 0.6);
  font-size: 0.82397rem;
  margin: 0.8rem 0 0;
  text-align: center; }

sub,
sup {
  font-size: 65%; }

hr {
  border: 0;
  height: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(255, 255, 255, 0.3); }

.btn, [type=button],
[type=submit],
button {
  background: #3A9C7D;
  border: none;
  border-radius: 2px;
  color: #ffffff;
  cursor: pointer;
  display: inline-block;
  font-size: 0.87891rem;
  font-weight: 500;
  line-height: 1.9;
  padding: 0.53333rem 1.33333rem;
  text-align: center;
  text-decoration: none;
  -webkit-transition: all .15s ease;
  -o-transition: all .15s ease;
  transition: all .15s ease;
  width: auto; }
  .btn:hover, [type=button]:hover,
  [type=submit]:hover,
  button:hover {
    background: #262626;
    color: #ffffff; }
  .btn:focus, [type=button]:focus,
  [type=submit]:focus,
  button:focus {
    outline: none; }
  .btn-outline {
    border: 1px solid #ddd;
    background: #ffffff;
    border-radius: 3px;
    color: #262626; }

[type=button],
[type=submit],
button {
  text-transform: uppercase;
  -webkit-appearance: none;
  -moz-appearance: none; }

.navbar {
  background: #3A9C7D;
  -webkit-box-shadow: 0 0 6px 0 rgba(0, 0, 0, 0.2);
  box-shadow: 0 0 6px 0 rgba(0, 0, 0, 0.2);
  line-height: 3;
  max-height: 4rem; }
  .navbar > div {
    -webkit-box-align: center;
    -ms-flex-align: center;
    align-items: center;
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-pack: center;
    -ms-flex-pack: center;
    justify-content: center;
    text-align: left;
    max-width: 700px;
    margin: 0 auto; }
  .navbar a {
    color: #ffffff;
    text-decoration: none; }
  .navbar-sidebar-toggle {
    left: 0;
    position: relative;
    text-indent: -99999rem; }
    .navbar-sidebar-toggle:before {
      content: "";
      display: block;
      border-top: 0.375rem double #ffffff;
      border-bottom: 0.125rem solid #ffffff;
      height: 0.125rem;
      position: absolute;
      text-indent: 0;
      top: 50%;
      width: 1.3rem;
      -webkit-transform: translate(0px, -50%);
      -ms-transform: translate(0px, -50%);
      transform: translate(0px, -50%); }


.logo {
                    background-image: url('https://fachrul.id/media/website/fachrulch-icon.png');
                    background-size: auto 2rem;
                    background-repeat: no-repeat;
                    background-position: center center;
            display: inline-block;
  font-weight: 600;
  line-height: 1;
            margin: 0 auto;
            height: 2rem;
            text-indent: -9999px;
            width: 240px;vertical-align: middle;
        }
        .logo.logo-text {
            line-height: 2;
            text-align: center;
            text-indent: 0;
        }

amp-sidebar {
  background: #ffffff;
  width: 240px; }
  amp-sidebar > ul {
    margin: 0.8rem 0 0;
    padding: 0; }
    amp-sidebar > ul ul {
      border-left: 1px solid #d4d4d4;
      margin: 0.53333rem 0 0; }
    amp-sidebar > ul li {
      color: #262626;
      font-size: 0.9375rem;
      font-weight: 600;
      list-style: none;
      line-height: 1.4;
      padding: 0.42667rem 1.06667rem; }
      amp-sidebar > ul li li {
        font-weight: normal;
        padding: 0.26667rem 0 0.26667rem 1.06667rem; }
    amp-sidebar > ul a,
    amp-sidebar > ul a:visited {
      color: #262626; }

.bg-white {
  background: #ffffff; }

.wrap-page {
  max-width: 700px;
  margin: 0 auto; }

@media all and (max-width: 43.6875em) {
  .wrap-inner {
    padding: 0 6%; } }

.page-title {
  background: #ffffff;
  -webkit-box-shadow: 0 2px 3px rgba(38, 38, 38, 0.1);
  box-shadow: 0 2px 3px rgba(38, 38, 38, 0.1);
  margin-bottom: 0.8rem;
  padding: 1.6rem 6%; }
  .page-title > h1 {
    margin: 0;
    font-size: 1.29454rem; }
  .page-title > p {
    font-size: 0.87891rem;
    color: #6c7175;
    line-height: 1.3;
    margin: 0.26667rem 0 0; }
  .page-title-author {
    border-radius: 50%;
    float: left;
    height: 2.5rem;
    width: 2.5rem; }
    .page-title-author + h1 {
      margin-left: 3.5rem; }
      .page-title-author + h1 + p {
        margin-left: 3.5rem; }

.card {
  background: #ffffff;
  -webkit-box-shadow: 0 2px 3px rgba(38, 38, 38, 0.1);
  box-shadow: 0 2px 3px rgba(38, 38, 38, 0.1);
  margin-bottom: 0.8rem;
  padding-bottom: 1.06667rem; }

  .card-meta {
    border-top: 1px solid #d4d4d4;
    color: rgba(108, 113, 117, 0.6);
    font-size: 0.7242rem;
    font-weight: 500;
    margin-top: 1.06667rem;
    padding-top: 1.06667rem;
    text-transform: uppercase; }
    .card-meta a + time:before {
      content: "";
      background: #d4d4d4;
      display: inline-block;
      height: 3px;
      margin: 0 8px;
      width: 3px;
      vertical-align: middle;
      border-radius: 50%; }
  .card-text {
    font-size: 0.9375rem;
    overflow: hidden;
    padding: 0 6%; }
    .card-text h2 {
      font-size: 1.13778rem; }

.post {
  margin-bottom: 2.13333rem; }
  .post-featured-image {
    margin-top: 0;
    position: relative; }
    .post-featured-image > figcaption {
      background: rgba(0, 0, 0, 0.5);
      border-radius: 3px;
      color: #ffffff;
      position: absolute;
      bottom: 0.8rem;
      padding: 0 0.26667rem;
      right: 6%; }
  .post-header {
    margin-bottom: 2.13333rem; }
  .post-meta {
    border-bottom: 1px solid #d4d4d4;
    color: rgba(108, 113, 117, 0.6);
    font-size: 0.7242rem;
    font-weight: 500;
    margin-top: 1.06667rem;
    padding-bottom: 1.06667rem;
    text-transform: uppercase; }
    .post-meta a + time:before {
      content: "";
      background: #d4d4d4;
      display: inline-block;
      height: 3px;
      margin: 0 8px;
      width: 3px;
      vertical-align: middle;
      border-radius: 50%; }
  .post-tag {
    margin: 0; }
    .post-tag > li {
      display: inline-block;
      padding: 0; }
      .post-tag > li a {
        background: #f1f1f1;
        border-radius: 2px;
        color: #6c7175;
        font-size: 0.77248rem;
        display: inline-block;
        margin: 0 0.26667rem 0.26667rem 0;
        padding: 0.26667rem 0.53333rem; }
        .post-tag > li a:hover {
          background: #3A9C7D;
          color: #ffffff;
          text-decoration: none; }
  .post-share {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-orient: horizontal;
    -webkit-box-direction: normal;
    -ms-flex-direction: row;
    flex-direction: row;
    -webkit-box-pack: justify;
    -ms-flex-pack: justify;
    justify-content: space-between;
    margin-top: 1.6rem;
    width: 100%; }
    .post-share amp-social-share {
      -webkit-box-flex: 1;
      -ms-flex: 1 0 auto;
      flex: 1 0 auto;
      background-size: 24px; }
  .post-scroll {
    color: #ffffff;
    background: #3A9C7D;
    bottom: 10px;
    border-radius: 50%;
    border: none;
    -webkit-box-shadow: 0 1px 1.5px 0 rgba(38, 38, 38, 0.12), 0 1px 1px 0 rgba(38, 38, 38, 0.24);
    box-shadow: 0 1px 1.5px 0 rgba(38, 38, 38, 0.12), 0 1px 1px 0 rgba(38, 38, 38, 0.24);
    font-size: 1.13778rem;
    height: 46px;
    opacity: 0;
    outline: none;
    position: fixed;
    padding: 0;
    right: 4%;
    visibility: hidden;
    width: 46px;
    z-index: 9999; }
    .post-scroll-marker {
      height: 0px;
      position: absolute;
      top: 100px;
      width: 0px; }
        .post-pagination {
    background: #f1f1f1;
    -webkit-box-shadow: inset 0 2px 3px rgba(38, 38, 38, 0.1);
    box-shadow: inset 0 2px 3px rgba(38, 38, 38, 0.1);
    border-top: 1px solid #d4d4d4;
    padding: 1.06667rem 0; }
    .post-pagination > div {
      line-height: 1.2;
      padding: 0.53333rem 1.06667rem;
      text-align: center; }
      .post-pagination > div span {
        display: block;
        color: #6c7175;
        font-size: 0.7242rem;
        font-weight: 500;
        margin-bottom: 0.26667rem;
        text-transform: uppercase; }
    .post-pagination-prev a:before {
      content: "\2190";
      margin-right: 0.26667rem; }
    .post-pagination-next a:after {
      content: "\2192";
      margin-left: 0.26667rem; }

aside {
  margin: 1.6rem 0 0; }

.align-left {
  text-align: left; }

.align-right {
  text-align: right; }

.align-center {
  text-align: center; }

.align-justify {
  text-align: justify; }

.msg {
  border-left: 2px solid transparent;
  padding: 1.06667rem 1.06667rem; }
  .msg--highlight {
    background-color: #fff8e6;
    border-color: #e2ac4f; }
  .msg--info {
    background: rgba(45, 97, 201, 0.03);
    border-color: #3A9C7D; }
  .msg--success {
    background: #f7fbf6;
    border-color: #5ab44b; }
  .msg--warning {
    background: #fff3f3;
    border-color: #c06367;
    color: #a94442; }

.dropcap:first-letter {
  float: left;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
  font-size: 2.16943rem;
  line-height: 0.7;
  margin-right: 0.53333rem;
  padding: 0.53333rem 0.53333rem 0.53333rem 0; }

.pagination {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: justify;
  -ms-flex-pack: justify;
  justify-content: space-between;
  margin: 0.8rem 0; }
  .pagination > a {
    padding-left: 0;
    padding-right: 0;
    width: 49%; }
  .pagination-right {
    margin-left: auto; }

.bottom {
  background: #3A9C7D;
  color: #ffffff;
  padding: 1.06667rem 4%;
  text-align: center; }</style><style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript><script async src="https://cdn.ampproject.org/v0.js"></script><script custom-element="amp-animation" src="https://cdn.ampproject.org/v0/amp-animation-0.1.js" async></script><script custom-element="amp-position-observer" src="https://cdn.ampproject.org/v0/amp-position-observer-0.1.js" async></script></head><body class="bg-white"><nav class="navbar wrap-inner" id="top"><div><a on="tap:navbar-sidebar.toggle" class="navbar-sidebar-toggle" title="Menu">Menu</a> <a class="logo" href="https://fachrul.id/amp/">Catatan celoteh @FachrulCH</a></div></nav><main class="wrap-page"><article class="post"><div class="wrap-inner"><header class="post-header"><h1>Struktur Framework dan Fluent Assertion - API Test Framework Python (Bagian 3)</h1><p class="post-meta">By <a href="https://fachrul.id/amp/authors/fachrulch/" rel="nofollow" title="Fachrul Choliluddin">Fachrul Choliluddin</a> <time datetime="2021-01-29T16:00">29 Jan 2021</time></p></header><p>Â </p><p>Hi Kawan ðŸ‘‹,</p><p>Gimana mudah kan belajar bikin API automation dengan python? tentunya,, di kesempatan ini kita akan belajar lebih lanjut dengan pytest dan menggunakan library tambahan (lagi) agar test kita lebih mudah dibaca dan dipahami dengan bantuan fluent assertionÂ </p><p>Artikel ini adalah salah satu dari rangkaian tutorial cara membuat RestfulAPI Test Framework dengan bahasa pemrograman Python, artikel lainnya bisa kamu cekidot disini ya:</p><ul><li><a href="https://fachrul.id/amp/yuk-belajar-cara-membuat-api-test-automation-framework-python-bagian-1/" target="_blank" rel="noopener noreferrer">PelajaranÂ 1:Â  Setup dan pengenalan HTTP requests</a></li><li><a href="https://fachrul.id/amp/api-test-automation-framework-python-bagian-2/" target="_blank" rel="noopener noreferrer">Pelajaran 2: Pengujian dengan assert dan pytest</a></li><li><a href="https://fachrul.id/amp/api-test-framework-python-struktur-framework-dan-fluent-assertion-bagian-3/" target="_blank" rel="noopener noreferrer">Pelajaran 3: Struktur awal test framework dan library fluent assertion</a></li><li><a href="https://fachrul.id/amp/refactoring-dan-base-api-api-test-framework-python-bagian-4/" target="_blank" rel="noopener noreferrer">Pelajaran 4: Refaktoring dan base helper</a></li><li><a href="https://fachrul.id/amp/reporting-api-test-framework-python-bagian-5/" target="_blank" rel="noopener noreferrer">Pelajaran 5: Reporting</a></li><li><a href="https://fachrul.id/amp/json-schema-validation-api-test-framework-python-extra-bonus/" target="_blank" rel="noopener noreferrer">Extra: Penambahan schema validation dan running test in parallel</a></li></ul><hr><h2>Kenapa kita perlu fluent assertion?</h2><p>Karena assert terlalu sederhana, dia hanya bisa mengevaluasi value True/False saja,, (eh tapi pada dasarnya semua juga sama sih mau pake library ini pun gitu, hahaha)</p><p>Maksudnya ada banyak fitur tambahan dari library ini, bisa dilihat dokumentasinya di web resminyaÂ <a href="https://github.com/assertpy/assertpy">https://github.com/assertpy/assertpy</a>Â dan secara kode pun akan mudah dibaca dan dipahami kok</p><p>Install library ini dengan command `pip install assertpy`</p><h2>Mengakses API method POST</h2><p>Oke kali ini kita ga akan pake GET airports lagi sebagai contoh, tapi kita akan menggunakan contoh API POST untuk menghitung jarak antar airports ya, kurang lebih kode nya akan seperti ini</p><pre><code class="language-python line-numbers">import requests
from assertpy import assert_that


def test_calculate_distance():
    payload = {
        "from": "LAE",
        "to": "NRT"
    }
    response = requests.post("https://airportgap.dev-tester.com/api/airports/distance", data=payload)
    data = response.json().get("data")
    assert_that(data["type"]).is_equal_to("airport_distance")
    assert_that(data["attributes"]).is_not_empty()
    assert_that(data).has_id("LAE-NRT")
    assert_that(data["attributes"]["kilometers"]).is_equal_to(4753.834755437252)</code></pre><p>Â Penjelasan kode, yang beda aja dari artikel sebelumnya ya hehe:</p><ul><li>from assertpy import assert_that ==&gt; melakukan import function assert_that yang berada pada module library assertpy</li><li>payload = {} ==&gt; deklarasi variable dengan tipe data dictionary</li><li>response = requests.post(&lt;url&gt;, data) ==&gt; nah seperti pada umumnya method POST adalah untuk mengirim data, maka kita akan mengirim data payload secara programatis dengan menggunakan argument tambahan data=payload</li><li>assert_that(&lt;condition&gt;).is_equal_to(&lt;expected result&gt;) ==&gt; penggunaan assertpy library untuk assertion, lihatlah kodenya jadi mudah dipahami bukan?</li></ul><hr><h2>Struktur Framework pytest</h2><p>Pada umumnya kode pengujian pada sebuah project python terletak pada directory `test` atau `tests`Â jadi untuk standarisasi kita akan mengikuti kaidah ini, sehingga bentuk project test kita menjadi seperti ini</p><pre>.<br>â””â”€â”€ test<br> â”œâ”€â”€ airport_test.py<br> â””â”€â”€ favorite_test.py</pre><p>Oia, sebagai convention pun kita perlu menamakan file kita dengan _test.py agar pytest bisa menemukan file mana saja yang akan dieksekusi sebagai test</p><p>Kita membagi dua file utnuk pengujian api yang berkaitan dengan airport dan favorite ke dalam file yang terpisah agar mudah dipahami, jadi semua test yang berkaitan dengan module favorite pasti terletak di favorite_test.py jadi test kita pun bisa menjadi sebuah dokumentasi yang baik</p><p>Kurang lebih contoh akhir dari file airport_test.py adalah seperti ini</p><pre><code class="language-python line-numbers">import requests
from assertpy import assert_that

BASE_URL = "https://airportgap.dev-tester.com/api"


def test_get_all_airports():
    response = requests.get(f'{BASE_URL}/airports')
    data = response.json().get('data')

    assert_that(response.status_code).is_equal_to(200)
    assert_that(data).is_greater_than_or_equal_to(5)


def test_get_airports_by_id():
    # arrange/GIVEN
    airport_id = "LAE"
    # action/WHEN
    response = requests.get(f'{BASE_URL}/airports/{airport_id}')
    data = response.json().get('data')
    data_airport = data["attributes"]
    # assertion/THEN
    assert_that(response.status_code).is_equal_to(200)
    assert_that(data_airport["name"]).is_equal_to("Nadzab Airport")


def test_get_not_found_airport():
    airport_id = "NOTFOUND"
    response = requests.get(f'{BASE_URL}/airports/{airport_id}')
    assert_that(response.status_code).is_equal_to(404)
    assert_that(response.json()).contains_key("errors")
    assert_that(response.text).contains("The page you requested could not be found")


def test_calculate_distance():
    payload = {
        "from": "LAE",
        "to": "NRT"
    }
    response = requests.post("https://airportgap.dev-tester.com/api/airports/distance", data=payload)
    data = response.json().get("data")
    assert_that(data["type"]).is_equal_to("airport_distance")
    assert_that(data["attributes"]).is_not_empty()
    assert_that(data).has_id("LAE-NRT")
    assert_that(data["attributes"]["kilometers"]).is_equal_to(4753.834755437252)
</code></pre><p>dan favorite_test.py</p><pre><code class="language-python line-numbers">from datetime import datetime

import requests
from assertpy import assert_that

BASE_URL = "https://airportgap.dev-tester.com/api"


def get_token(email, password):
    return requests.post(BASE_URL + "/tokens", data={
        "email": email,
        "password": password
    })


def get_my_favorite_airport(token):
    header = {
        "Authorization": f"Token {token}"
    }
    return requests.get(BASE_URL + "/favorites", headers=header)


def test_token():
    token = get_token(email="naruto@mailinator.com", password="shuriken")
    assert_that(token.status_code).is_equal_to(200)
    assert_that(token.json()).contains_key("token")
    assert_that(token.json().get("token")).is_not_empty()


def test_get_favorite():
    give_me_token = get_token(email="naruto@mailinator.com", password="shuriken")
    token = give_me_token.json().get("token")
    header = {
        "Authorization": f"Token {token}"
    }
    response = requests.get(BASE_URL + "/favorites", headers=header)
    data = response.json().get("data")
    assert_that(response.status_code).is_equal_to(200)
    assert_that(data).is_greater_than_or_equal_to(1)


def test_add_new_favorite():
    """
    Since the data is hardcoded, then it was not idempotent/repeatable
    This test will failed, if NRT already in my favorite list
    Need to remove after test teardown
    """
    give_me_token = get_token(email="naruto@mailinator.com", password="shuriken")
    token = give_me_token.json().get("token")

    before_add = get_my_favorite_airport(token)
    data_before = before_add.json().get("data")
    assert_that(before_add.text).does_not_contain("NRT")

    new_airport = {
        "airport_id": "NRT",
        "note": "I like Narita"
    }

    header = {
        "Authorization": f"Token {token}"
    }

    response = requests.post(BASE_URL + "/favorites", headers=header, data=new_airport)
    assert_that(response.status_code).is_equal_to(201)
    response_data = response.json().get("data")
    assert_that(response_data["attributes"]["airport"]["iata"]).is_equal_to(new_airport["airport_id"])
    assert_that(response_data["attributes"]["note"]).is_equal_to(new_airport["note"])

    after_add = get_my_favorite_airport(token)
    data_after = after_add.json().get("data")
    assert_that(len(data_after)).is_greater_than(len(data_before))
    assert_that(after_add.text).contains(new_airport["note"])


def test_update_favorite_note():
    give_me_token = get_token(email="naruto@mailinator.com", password="shuriken")
    token = give_me_token.json().get("token")

    before_add = get_my_favorite_airport(token)
    data_before = before_add.json().get("data")

    assert_that(len(data_before)).is_greater_than(0)
    id_airport_to_modify = data_before[0]["id"]

    header = {
        "Authorization": f"Token {token}"
    }

    # Add dynamic unique string with a timestamp
    new_note = {
        "note": f"The note for ID:{id_airport_to_modify} is changed at time: {datetime.now()} "
    }

    response = requests.patch(f"{BASE_URL}/favorites/{id_airport_to_modify}", headers=header, data=new_note)
    assert_that(response.status_code).is_equal_to(200)
    assert_that(response.text).contains(new_note["note"])

    after_add = get_my_favorite_airport(token)
    data_after = after_add.json().get("data")
    for airport_data in data_after:
        if airport_data["id"] == id_airport_to_modify:
            print(f"Found the modified airport {id_airport_to_modify}")
            print("\nHere is the check for specific airport in an array data")
            assert_that(airport_data["attributes"]["note"]).is_equal_to(new_note["note"])


def test_delete_favorite():
    give_me_token = get_token(email="naruto@mailinator.com", password="shuriken")
    token = give_me_token.json().get("token")

    before_add = get_my_favorite_airport(token)
    data_before = before_add.json().get("data")

    assert_that(len(data_before)).is_greater_than(0)
    id_airport_to_delete = data_before[0]["id"]

    header = {
        "Authorization": f"Token {token}"
    }

    response = requests.delete(f"{BASE_URL}/favorites/{id_airport_to_delete}", headers=header)
    assert_that(response.status_code).is_equal_to(204)
    after_delete = get_my_favorite_airport(token)
    data_after = after_delete.json().get("data")
    assert_that(len(data_after)).is_less_than(len(data_before))</code></pre><p>Penjelasan kode? hmm sepertinya akan sangat panjang, nanti akan saya jelaskan pada video sepertinya agar lebih runut ehehe, klo nulis keknya panjang ehehe</p><h2>Bagaimana cara menjalankan kode dengan pytest?</h2><p>Klo mau menjalankan satu satu sih bisa seperti cara sebelumnya `Â pytest test/airport_test.py`</p><p>Tapi klo mau menjalankan seluruh test, karena sudah sesuai convention (dalam folder test, file sudah bearakhiran xxx_test.py dan method berawalan test_xxx) sebenarnya cukup menggunakan `pytest` saja tanpa embel embel loh</p><hr><p>Cukup sekian tutorial kali ini, silakan teman-teman pelajari approach saya dalam menulis kode di atas, apakah sudah test nya seperti itu? atau kamu mungkin punya assertion yang bisa jadi ditambahkan juga, silakan tulis di kolom komentar di bawah ya!</p><p>Â Berikutnya kita akan bahas, bagaimana kode ini bisa kita refactor dengan menggunakan class Base API ya</p><p>Salam!</p><p>Selengkapnya ada pula di video live coding berikut ini:</p><div class="post__iframe"><amp-iframe sandbox="allow-scripts allow-same-origin" layout="responsive" width="560" height="315" src="https://www.youtube.com/embed/8XcDzl5vVBU" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="allowfullscreen"></amp-iframe></div><aside><ul class="post-tag"><li><a href="https://fachrul.id/amp/celoteh/automation-python/">automation-python</a></li><li><a href="https://fachrul.id/amp/celoteh/tutorials/">tutorials</a></li></ul><div class="post-share"><amp-social-share type="system" width="40" height="40" data-param-text="Struktur Framework dan Fluent Assertion - API Test Framework Python (Bagian 3)"></amp-social-share><amp-social-share type="facebook" width="40" height="40" data-param-app_id="" data-param-text="Struktur Framework dan Fluent Assertion - API Test Framework Python (Bagian 3)" data-param-href="https://fachrul.id/amp/api-test-framework-python-struktur-framework-dan-fluent-assertion-bagian-3/"></amp-social-share><amp-social-share type="twitter" width="40" height="40" data-param-text="Struktur Framework dan Fluent Assertion - API Test Framework Python (Bagian 3)" data-param-url="https://fachrul.id/amp/api-test-framework-python-struktur-framework-dan-fluent-assertion-bagian-3/"></amp-social-share><amp-social-share type="whatsapp" width="40" height="40" data-param-text="Struktur Framework dan Fluent Assertion - API Test Framework Python (Bagian 3)" data-param-url="https://fachrul.id/amp/api-test-framework-python-struktur-framework-dan-fluent-assertion-bagian-3/"></amp-social-share></div></aside></div></article><nav class="post-pagination wrap-inner"><div class="post-pagination-prev"><span>Previous</span> <a href="https://fachrul.id/amp/api-test-automation-framework-python-bagian-2/">Assert dan Pytest - API Test Framework Python (Bagian 2)</a></div><div class="post-pagination-next"><span>Next</span> <a href="https://fachrul.id/amp/membentuk-pola-pikir-entrepreneurship-dalam-bekerja-sebagai-karyawan/">Membentuk Pola Pikir Entrepreneurship dalam Bekerja Sebagai Karyawan</a></div></nav></main><amp-animation id="showAnim" layout="nodisplay"><script type="application/json">{
                    "duration": "200ms",
                    "fill": "both",
                    "iterations": "1",
                    "direction": "alternate",
                    "animations": [{
                        "selector": ".post-scroll",
                        "keyframes": [{
                            "opacity": "1",
                            "visibility": "visible",
                            "transform": "scale(1)"
                        }]
                    }]
                }</script></amp-animation><amp-animation id="hideAnim" layout="nodisplay"><script type="application/json">{
                    "duration": "200ms",
                    "fill": "both",
                    "iterations": "1",
                    "direction": "alternate",
                    "animations": [{
                        "selector": ".post-scroll",
                        "keyframes": [{
                            "opacity": "0",
                            "visibility": "hidden",
                            "transform": "scale(0.1)"
                        }]
                    }]
                }</script></amp-animation><div class="post-scroll-marker"><amp-position-observer on="enter:hideAnim.start; exit:showAnim.start" layout="nodisplay"></amp-position-observer></div><button class="post-scroll" on="tap:top.scrollTo(duration=200)">&#8593;</button><footer class="bottom">"Ikatlah ilmu dengan menulisnya"</footer><amp-sidebar id="navbar-sidebar" layout="nodisplay"><ul><li><a href="https://fachrul.id/">Beranda</a></li><li><a href="https://fachrul.id/amp/daftar-isi/">Daftar Isi</a></li><li><a href="https://fachrul.id/amp/celoteh/tutorials/">Panduan</a></li><li><a href="https://fachrul.id/amp/about-fachrulch/">Tentang Saya</a></li></ul></amp-sidebar><amp-analytics type="googleanalytics" id="analytics1"><script type="application/json">{
            "vars": {
                "account": "UA-133827625-1"
            },
            "triggers": {
                "trackPageview": {
                    "on": "visible",
                    "request": "pageview"
                }
            }
        }</script></amp-analytics></body></html>